# 考勤统计工具 - 改进启动体验方案

## 当前问题

- 双击 exe 启动时没有任何视觉反馈
- 关闭时需要按 Ctrl+C，不友好
- 不知道程序是否正在运行

---

## 方案一：添加启动画面（推荐）

使用 Launch4j 的 Splash Screen 功能，添加启动画面和托盘图标。

### 操作步骤

### 1. 准备图标文件

准备一个 `.ico` 图标文件（建议 256x256 像素）：
- 在线制作：https://www.icoconverter.com/
- 或从 PNG 转换

保存为：`app.ico` 放在项目目录

### 2. 修改 Launch4j 配置

在 **Header** 标签页，添加以下配置：

| 配置项 | 设置 |
|---------|------|
| **Header Type** | 选择 `GUI` |
| **Icon** | 浏览选择 `app.ico` |

在 **JRE** 标签页：

| 配置项 | 设置 |
|---------|------|
| 勾选 **Bundled JRE** | ✓ |

在 **Splash** 标签页：

| 配置项 | 设置 |
|---------|------|
| **Splash screen** | ✓ 勾选 |
| **Splash file** | 浏览选择或制作一个启动图 |
| **Splash screen timeout** | `10`（秒） |
| **Timeout when no splash** | `10` |

在 **Message** 标签页：

| 配置项 | 设置 |
|---------|------|
| **Show header** | ✓ 勾选 |
| **Header Text** | 考勤统计工具正在启动... |
| **Header Color** | 选择一个颜色（如 #667eea） |
| **Show message** | ✓ 勾选 |
| **Message Text** | 正在启动服务，请稍候... |

### 3. 构建并测试

点击 **Build** 重新构建 exe

**启动效果：**
- 双击 exe → 显示启动画面 → 自动打开浏览器
- 启动画面显示 10 秒后自动关闭

---

## 方案二：添加系统托盘图标（更专业）

### 1. 下载和安装 WinRun4j

WinRun4j 可以将 Java 程序注册为 Windows 服务，添加托盘图标。

**下载地址：** https://github.com/winaps/winrun4j

### 2. 创建托盘配置文件

在项目目录创建 `app-tray.xml`：

```xml
<launch4j>
  <option>
    <name>headerType</name>
    <value>gui</value>
  </option>
  <option>
    <name>errTitle</name>
    <value>考勤统计工具</value>
  </option>
  <singleInstance>
    <mutexName>考勤统计工具</mutexName>
    <mutexFolder>.${USERHOME}\.考勤统计工具</mutexFolder>
  </singleInstance>
</launch4j>
```

### 3. 在 Launch4j 中使用

在 **Launch4j Config** 选择此配置文件。

---

## 方案三：最简方案 - 使用 bat 脚本（推荐给财务）

创建一个友好的 bat 脚本，带启动提示。

### 创建 `启动考勤工具.bat`

```batch
@echo off
chcp 65001 >nul
title 考勤统计工具

echo.
echo ========================================
echo    考勤统计工具 启动中...
echo ========================================
echo.

REM 检查程序是否已运行
tasklist /FI "IMAGENAME eq java.exe" /NH | find /I /N "java.exe" >nul
if %ERRORLEVEL% equ 0 (
    echo.
    echo [警告] 检测到 Java 程序正在运行
    echo.
    echo 请选择操作：
    echo 1. 打开浏览器
    echo 2. 结束程序
    echo.
    set /p choice=请输入选项 (1/2):
    if "!choice!"=="1" (
        start http://localhost:8080
    ) else if "!choice!"=="2" (
        echo 正在关闭程序...
        taskkill /F /IM java.exe
    )
    pause
    exit
)

REM 启动程序
echo [INFO] 正在启动考勤统计工具...
echo.
start java -jar ai-work-1.0.0.jar

echo.
echo ========================================
echo    程序已启动！
echo ========================================
echo.
echo 浏览器访问地址：
echo   http://localhost:8080
echo.
echo 使用说明：
echo   1. 程序会在系统托盘运行
echo   2. 关闭此窗口不影响程序运行
echo   3. 完全关闭程序：请打开任务管理器结束 Java 进程
echo.
echo ========================================

REM 3秒后自动关闭此窗口
timeout /t 3 >nul

exit
```

### 创建 `关闭考勤工具.bat`

```batch
@echo off
chcp 65001 >nul
title 关闭考勤统计工具

echo.
echo ========================================
echo    正在关闭考勤统计工具
echo ========================================
echo.

tasklist /FI "IMAGENAME eq java.exe" /NH | find /I /N "java.exe" >nul
if %ERRORLEVEL% equ 0 (
    taskkill /F /IM java.exe
    echo.
    echo [成功] 考勤统计工具已关闭
) else (
    echo.
    echo [提示] 未检测到运行中的考勤统计工具
)

echo.
pause
```

---

## 方案四：使用 jpackage（JDK 16+ 自带）

JDK 16+ 自带 jpackage 工具，可以打包成 msi 或 exe。

### 使用命令

```bash
# 创建安装包
jpackage \
  --input target/classes \
  --name 考勤统计工具 \
  --main-jar ai-work-1.0.0.jar \
  --main-class com.example.aiwork.AiWorkApplication \
  --type exe \
  --win-console \
  --win-shortcut \
  --win-dir-chooser \
  --win-menu \
  --vendor "您的公司名"
```

---

## 推荐的最终文件结构

```
考勤统计工具/
├── app/
│   ├── ai-work-1.0.0.jar
│   ├── 启动考勤工具.bat      ← 双击这个启动
│   ├── 关闭考勤工具.bat      ← 双击这个关闭
│   └── app.ico               ← 图标文件
├── 考勤统计工具.exe           ← Launch4j 生成
├── 使用说明.txt
└── README.md
```

---

## 使用说明.txt 内容

```
考勤统计工具 - 使用说明
====================

【快速启动】
双击 "启动考勤工具.bat" 即可

【启动后】
- 浏览器会自动打开工具页面
- 本窗口会在 3 秒后自动关闭
- 程序在后台运行

【关闭工具】
方法1：双击 "关闭考勤工具.bat"
方法2：关闭浏览器窗口
方法3：在任务管理器中结束 Java 进程

【注意事项】
- 请确保端口 8080 未被占用
- 如遇问题请重启电脑后重试
- 建议 Windows 10 以上使用

【技术支持】
GitHub: https://github.com/keidbye/ai-work
```

---

## 需要我帮您生成这些文件吗？

我可以帮您：
1. 创建启动和关闭的 bat 脚本
2. 修改 Launch4j 配置添加启动画面
3. 整理成完整的发布包结构
