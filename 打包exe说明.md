# 考勤统计工具 - 打包成 exe 说明文档

## 方案A：Launch4j 打包成 exe

本工具使用 Spring Boot + Thymeleaf 开发，需要打包成独立的 exe 程序给财务同事使用。

---

## 一、准备工作

### 1.1 下载 Launch4j
- **下载地址**：https://launch4j.sourceforge.net/
- **选择版本**：`launch4j-3.50-win32.exe` 或 `launch4j-9.exe`
- **安装路径建议**：`C:\Program Files\Launch4j\`

### 1.2 下载 JRE 17（必需，本程序需要 Java 17）
- **下载地址**：https://adoptium.net/
- **选择配置**：
  - Version: `Temurin 17 (LTS)`
  - Operating System: `Windows`
  - Architecture: `x64`
  - Package Type: `.zip` (JRE)
- **解压位置**：`C:\jre17`

---

## 二、打包项目

### 2.1 在项目目录执行打包命令

```bash
# 进入项目目录
cd ai-work

# 清理并打包（跳过测试）
mvn clean package -DskipTests
```

打包成功后，会在 `target/` 目录下生成 `ai-work-1.0.0.jar` 文件。

---

## 三、使用 Launch4j 制作 exe

### 3.1 打开 Launch4j
```
开始菜单 → Launch4j → launch4j.exe
```

### 3.2 新建配置
点击左上角 **"新建"** 按钮（或 File → New）

### 3.3 基本配置

在 **"Basic"** 标签页填写：

| 配置项 | 填写内容 |
|--------|----------|
| **Output file** | 点击浏览，选择输出位置：<br>例如：`C:\考勤统计工具\考勤统计工具.exe` |
| **Jar** | 点击浏览，选择：<br>`项目目录\target\ai-work-1.0.0.jar` |
| **Icon** | （可选）选择 .ico 格式图标文件 |
| **Min JRE version** | 填写：`17` |
| **Max JRE version** | 留空 |

### 3.4 JRE 配置（重要！）

切换到 **"JRE"** 标签页：

| 配置项 | 填写内容 |
|--------|----------|
| **Bundled JRE path** | 选择之前解压的 JRE：<br>`C:\jre17\jre` |
| **Min JRE version** | `17` |
| **Max JRE version** | 留空 |
| **Initial heap size** | `256` |
| **Max heap size** | `1024` |
| 勾选 **"Bundled JRE"** | ✓ |
| 勾选 **"Allow only one instance"** | ✓（防止重复启动） |

### 3.5 启动配置（可选）

切换到 **"Header"** 标签页：

| 配置项 | 填写内容 |
|--------|----------|
| **Header type** | 选择 `GUI` |
| 勾选 **"Stay alive"** | ✓ |
| 勾选 **"Hide console"** | ✓（不显示控制台窗口） |

### 3.6 保存配置

点击 **"保存"** 按钮，将配置保存为 `.l4j` 文件，方便下次使用。

### 3.7 构建 exe

点击工具栏上的 **"构建"** 按钮（或按 F9 键）

等待几秒，成功后会在指定位置生成 `考勤统计工具.exe`

---

## 四、制作发布包

### 4.1 创建发布文件夹结构

```
考勤统计工具/
├── 考勤统计工具.exe      ← 主程序
├── 使用说明.txt          ← 使用说明
├── 启动工具.bat          ← 备用启动脚本
└── README.md            ← 本文档
```

### 4.2 启动脚本内容

**启动工具.bat：**
```batch
@echo off
chcp 65001 >nul
cd /d %~dp0

echo ========================================
echo   考勤统计工具 - 启动中...
echo ========================================
echo.

start "" "考勤统计工具.exe"

timeout /t 3 >nul

echo 服务已启动，请使用浏览器访问：
echo http://localhost:8080
echo.
pause
```

---

## 五、使用说明

### 5.1 给财务同事的使用说明

**使用说明.txt：**
```
考勤统计工具 使用说明
==================

【安装与启动】
1. 将整个文件夹复制到电脑任意位置
2. 双击运行 "考勤统计工具.exe"
3. 浏览器会自动打开，显示工具页面

【使用步骤】
1. 拖拽 Excel 文件到 "上传考勤文件" 区域
   支持格式：.xlsx

2. （可选）设置休息日
   格式：2026/01/01（每行一个）
   留空则自动识别周六日

3. （可选）设置特殊规则员工
   用逗号或换行分隔姓名
   特殊员工统计19-21点和21-05点加班小时数

4. 点击 "开始计算" 按钮
   等待处理完成

5. 查看统计结果表格
   特殊员工行会以黄色高亮显示

6. 点击 "导出 Excel" 按钮
   下载统计结果文件

【技术支持】
- 程序运行在 8080 端口
- 请确保防火墙允许此端口
- 如遇问题，请联系技术支持

【关闭程序】
- 使用完成后，直接关闭打开的浏览器窗口即可
- 或按 Ctrl+C 关闭命令行窗口
```

---

## 六、测试验证

打包完成后，请进行以下测试：

1. **启动测试**
   - 双击 exe 文件
   - 确认浏览器自动打开 http://localhost:8080
   - 页面显示正常

2. **功能测试**
   - 上传测试文件
   - 计算统计结果
   - 导出 Excel 文件

3. **兼容性测试**
   - 在 Windows 10/11 上测试
   - 确认防火墙提示正常

---

## 七、常见问题

### Q1: 启动后浏览器无法打开？
**A:** 检查 8080 端口是否被占用，或等待几秒后手动访问 http://localhost:8080

### Q2: 导出的 Excel 打开显示乱码？
**A:** 使用 Excel 2016+ 打开，或用 WPS Office 打开

### Q3: 程序无法启动？
**A:** 确保文件夹完整，不要移动或删除任何文件

---

## 八、联系支持

如有问题或建议，请联系技术支持。

GitHub: https://github.com/keidbye/ai-work
