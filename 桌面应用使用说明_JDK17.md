# 考勤统计工具 - 桌面应用使用说明

## 一、环境要求

### 1.1 JDK 版本
- **JDK 17** （您当前使用的版本）
- JDK 17 不包含 JavaFX，需要单独安装

### 1.2 安装 JavaFX 17

**下载地址：** https://openjfx-cn.org/

**安装步骤：**

1. 下载 **JavaFX 17 SDK** （Windows x64 版本）
   - 文件名类似：`javafx_sdk-17_0_XX-windows-x64-bin.zip`

2. 解压到固定位置，例如：`C:\JavaFX\`
   - 最终目录结构：`C:\JavaFX\javafx-sdk-17\0.XX\`

3. 配置环境变量
   - 添加系统变量：`JAVAFX_PATH`
   - 值：`C:\JavaFX\javafx-sdk-17\0.XX\`

---

## 二、启动应用

### 2.1 双击启动脚本

双击 **`启动桌面应用.bat`** 即可启动桌面应用

**启动流程：**
1. 脚本检测 Java 版本（需 JDK 17）
2. 检查 JavaFX 模块是否就绪
3. 启动内置浏览器打开应用
4. 应用窗口自动显示（1150 x 750 像素）

### 2.2 应用窗口

- **窗口标题：** 考勤统计工具
- **页面加载中：** 显示"考勤统计工具 - 正在启动..."
- **加载完成：** 显示"考勤统计工具"
- **窗口可调整：** 支持拖动调整大小

### 2.3 关闭应用

双击 **`关闭桌面应用.bat`** 可选择：
- 选项1：仅关闭应用窗口（后台服务继续运行）
- 选项2：强制结束所有程序（包括后台服务）

---

## 三、使用说明

### 3.1 上传文件

1. 点击"上传考勤文件"区域或拖拽文件
2. 支持 `.xlsx` 和 `.xls` 格式

### 3.2 设置参数

**休息日设置：**
- 格式：`2026/01/01`
- 每行一个日期
- 留空则自动识别周六日

**特殊规则员工：**
- 姓名用逗号或换行分隔
- 特殊员工统计 19:00-21:00 和 21:00-05:00 加班小时数
- 不统计小时数和周末补贴次数

### 3.3 计算和导出

1. 点击"开始计算"查看统计结果
2. 点击"导出 Excel"下载结果文件

### 3.4 特殊员工高亮

特殊规则员工的统计行会以黄色背景高亮显示

---

## 四、注意事项

### 4.1 防火墙

- 确保防火墙允许 `java.exe` 通讯
- 确保 8080 端口未被占用

### 4.2 端口占用

如遇端口占用提示：
1. 检查是否有其他实例在运行
2. 使用"关闭桌面应用.bat"选项2停止所有进程

### 4.3 页面加载失败

如页面加载失败：
1. 等待 10-20 秒让后台服务完全启动
2. 检查控制台日志输出

---

## 五、技术支持

如有问题请联系技术支持。

GitHub: https://github.com/keidbye/ai-work
